@model TheDmScreen.Models.EncounterFeedEntry

<div class="row">
    <h3>Edit @Model.ActingCharacter.Name's Turn</h3>
    <br />
</div>
<div class="row">
    <h5>Action Description</h5>
    <div class="large-8 columns">
        <textarea onkeyup=" auto_grow(this) " id="updateDescription">@Model.Description</textarea>
    </div>
    <ul class="button-group large-4 columns">
        <li id="ModalUpdate" class="button">Update</li>
        <li id="ModalDelete" class="button">Delete</li>
    </ul>
</div>

<a class="close-reveal-modal" aria-label="Close">&#215;</a>
<input type="hidden" id="entryId" value="@Model.EncounterFeedEntryId" />

<style>
    textarea {
        resize: none;
        overflow: hidden;
        min-height: 50px;
        max-height: 100px;
    }
</style>

<script>
    function auto_grow(element) {
        element.style.height = "5px";
        element.style.height = (element.scrollHeight) + "px";
    }

    $("#ModalCancel").click(function () {
        $("#myModal").foundation("reveal", "close");
    });

    $(document).ready(function () {
        $("#ModalUpdate").click(function () {
            var commitData = { entryId: $("#entryId").val(), description: $("#updateDescription").val() };

            $.ajax({
                url: "/Initiative/UpdateEntry",
                dataType: "json",
                type: "PUT",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify(commitData),
                async: true,
                processData: false,
                cache: false,
                success: function (data) {
                    var url = '@Url.Action("Encounter", "Initiative", new { id = "__id__" })';
                    window.location.href = url.replace('__id__', $("#encounterId").val());
                },
                error: function (xhr) {
                    alert("Oops, something got screwed up here");
                }
            });
        });

        $("#ModalDelete").click(function () {
            var deleteData = { entryId: $("#entryId").val() };

            $.ajax({
                url: "/Initiative/DeleteEntry",
                dataType: "json",
                type: "PUT",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify(deleteData),
                async: true,
                processData: false,
                cache: false,
                success: function (data) {
                    var url = '@Url.Action("Encounter", "Initiative", new { id = "__id__" })';
                    window.location.href = url.replace('__id__', $("#encounterId").val());
                },
                error: function (xhr) {
                    alert("Oops, something got screwed up here");
                }
            });
        });
    });
</script>